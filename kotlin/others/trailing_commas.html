<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>πの実</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="忙しい人のための Effective Kotlin 超要約 Item 19: Do not repeat knowledge"
    />
    <meta
      name="keywords"
      content="Kotlin, Effective Kotlin, 忙しい人のための"
    />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/js/highlight/styles/darcula.css" />
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script
    ><![endif]-->
  </head>

  <script type="text/javascript" src="/js/embed-date.js"></script>
  <script src="/js/highlight/highlight.pack.js"></script>
  <script src="/js/embed-content-list.js"></script>
  <script type="text/javascript">
    window.addEventListener(
      "load",
      function () {
        embedDate("kotlin", "others", "trailing_commas");
        embedContentList();
      },
      false
    );
    hljs.initHighlightingOnLoad();
  </script>

  <body>
    <div id="menubar">
      <ul>
        <li><a href="/index.html">Home</a></li>
        <li>
          <a>Contents <span class="caret"></span></a>
          <div>
            <ul id="contents"></ul>
          </div>
        </li>
      </ul>
    </div>
    <div id="container">
      <header>
        <div id="logo" style="text-align: center">
          <a href="/index.html">
            <img src="/images/logo.png" style="width: 150px; height: 46px"
          /></a>
        </div>
      </header>

      <div id="date" style="text-align: right"></div>

      <h1>まとめ</h1>
      <ul>
        <li>
          <b>Kotlin 1.4以降では</b>コレクションやメソッド引数の最終要素に","
          (trailing comma) を残しておいてもコンパイルエラーになりません
        </li>
        <li>trailing comma があってもなくてもコードの動作は一切変わりません</li>
        <li>
          trailing comma
          をつけるようにしておくと、チーム開発するときのレビューがしやすくなります
          (コレクションやメソッドの引数に変更を加えても、追加削除した行だけが変更点として表示されるから)
        </li>
      </ul>

      <h1>ちょっと詳しく</h1>
      <h2>Trailing comma (末尾のカンマ)</h2>
      <p>
        コレクションの要素やメソッドのパラメータなど、同列の要素を複数個並べたいときは下記のようにカンマで区切って並べます。
        この時、最後の要素の後には","を書かないのが一般的かと思います。 実際、<b
          >Kotlin 1.4より古いバージョン</b
        >では、余分なコンマを付けているとコンパイルエラーになります。
      </p>
      <pre>
        <code>
          val colors = listOf(
              "red",
              "green",
              "blue" // <-ここにはカンマをつけていない
          )

        </code>
      </pre>

      <p>
        ところが<b>Kotlin 1.4以降</b
        >では、最終要素の後ろにも","を残しておいてOKになりました。
        この余分なカンマのことを <b>trailing comma</b> と呼びます。
      </p>

      <h2>なにがうれしい？</h2>
      <p>
        trailing comma があってもなくてもコードの動作には一切影響ありません。
      </p>

      <p>
        trailing comma
        が若干ありがたく感じるのは、チームで開発を進めて、お互いにコードをレビューしあうような状況でしょうか。
        開発を進めていくと、既存のメソッドにパラメータを追加したり、逆に削除したくなることはよくあるかと思いますが、この時に
        "これは最後の要素だからカンマを消して…" とか考える必要がなくなります。
        カンマの追加/削除が本質的な変更点ではありえないでしょうから、余計な変更を加える必要がなくなり、<b>コードレビューをするときも、本質的な変更点だけに集中</b>することができるようになります。
      </p>

      <p>
        配列やパラメータの順番だけを変更するときも幾分やりやすくなっているかと思います。
        カンマのあるなしは気にせず、配列の行丸ごとの置換でOKになります。<a
          href="https://kotlinlang.org/docs/whatsnew14.html#trailing-comma"
          >公式ドキュメント</a
        >にもその旨記述があります。 多分ありがたいのはこれくらいでしょうか。
      </p>

      <p>
        コンマとカンマで表記ゆれがあることに気づきました…。
        アドバイスとアドヴァイスみたいな。カタカナで発音を表現しようとしている時点で間違ってますから、どっちでもいいですよね。
      </p>
    </div>
  </body>
</html>
